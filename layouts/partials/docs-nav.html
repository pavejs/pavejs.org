<nav class="w-full flex">
  {{- $url := split .Permalink "/" -}}
  {{- $page_slug := index $url (sub (len $url) 2) -}}
  <ul class="list-none w-full">
  {{- range $group := .Site.Data.sidebar -}}
    {{- $link := $group.title -}}
    {{- $link_slug := $link | urlize -}}
    {{- if $group.content -}}
      {{- $link = index $group.content 0 -}}
      {{- $link_slug = $link.title | urlize -}}
    {{- end -}}
    {{- $group_slug := $group.title | urlize -}}
    {{- $is_active_group := eq $.Page.Params.group $group_slug -}}
    {{- if $group.content }}
      <li class="flex w-full">
        <button class="w-full inline-flex items-center flex-1 flex justify-between space-x-4 font-semibold text-sm cursor-pointer hover:bg-gray-200 whitespace-nowrap p-3 text-blue-500 hover:text-blue-600 uppercase font-bold text-sm{{ if not $is_active_group }} collapsed{{ end }}">
          <span>{{ $group.title }}</span>
          <img src='node_modules/bootstrap-icons/icons/chevron-right.svg' class="transition-all h-4 w-4 transform{{ if $is_active_group }} rotate-90{{ else }} rotate-0{{ end }}" />
        </button>
        <div class="{{ if $is_active_group }} flex{{ else }} hidden{{ end }}">
          <ul class="list-none text-base pb-1">
            {{- range $section := $group.content -}}
              {{- $section_slug := $section.title | urlize -}}
              {{- $is_active := and $is_active_group (eq $page_slug $section_slug) -}}
              {{- $href := printf "/docs/%s/%s/%s/" $group_slug $section_slug }}
              <li class="flex w-full"><a href="{{ $href }}" class="inline-flex flex-1 flex justify-between space-x-4 font-semibold text-sm cursor-pointer hover:text-gray-500 hover:bg-gray-200 whitespace-nowrap p-3 text-gray-600 text-xs{{ if $is_active }} text-gray-800{{ end }}">
                {{ $section.title }}
              </a></li>
            {{- end }}
          </ul>
        </div>
      </li>
    {{- else }}
      <li class="py-3 px-4 border-t w-full"></li>
      <li class="flex w-full"><a href="/docs/{{ $group_slug }}/" class="inline-flex flex-1 justify-between space-x-4 font-semibold text-sm cursor-pointer hover:text-gray-500 hover:bg-gray-200 whitespace-nowrap p-3 text-gray-600 text-xs{{ if $is_active_group }} text-gray-800{{ end }}">
        {{ $group.title }}
      </a></li>
    {{- end }}
  {{- end }}
  </ul>
</nav>